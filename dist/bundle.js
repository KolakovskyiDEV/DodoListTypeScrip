/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/

//— Добавить к каждому todo item который создается при сабмите формы поле completed
//— поле completed должно содержать false когда пользователь только что создал todo item
//— Поле completed можно изменить прямо из элемента todo http://joxi.ru/GrqX0JLf4v1Y5A — нужно добавить в него checkbox
//— Если задача не выполнена — нежно чтобы в чекбоксе не было галочки, а если выполнена — чтобы была (сразу после создания todo item галочки нету)
//— Если пользователь нажимает на текущем элементе на галочку то нужно изменять статус текущей задачи на выполненный (completed: true)
//— Так как все todo items у нас хранятся в массиве внутри localStorage то с ним нам и нужно работать
//— Добавить возможность удалять каждый отдельный todo item
//— Добавить возможность удалять сразу все todo items
// // "use strict";
// // //— Добавить к каждому todo item который создается при сабмите формы поле completed
// // //— поле completed должно содержать false когда пользователь только что создал todo item
// // //— Поле completed можно изменить прямо из элемента todo http://joxi.ru/GrqX0JLf4v1Y5A — нужно добавить в него checkbox
// // //— Если задача не выполнена — нежно чтобы в чекбоксе не было галочки, а если выполнена — чтобы была (сразу после создания todo item галочки нету)
// // //— Если пользователь нажимает на текущем элементе на галочку то нужно изменять статус текущей задачи на выполненный (completed: true)
// // //— Так как все todo items у нас хранятся в массиве внутри localStorage то с ним нам и нужно работать
// // //— Добавить возможность удалять каждый отдельный todo item
// // //— Добавить возможность удалять сразу все todo items
var TodoModel = /** @class */ (function () {
    function TodoModel() {
        this.dbName = "saved_data";
        this._countOfIcons = 0;
        // this.dbName = "saved_data";
        // this.num = 0;
    }
    Object.defineProperty(TodoModel.prototype, "countOfIcons", {
        get: function () {
            return this._countOfIcons;
        },
        set: function (numberValue) {
            this._countOfIcons = numberValue;
        },
        enumerable: false,
        configurable: true
    });
    TodoModel.prototype.saveData = function (todoItem) {
        if (localStorage[this.dbName]) {
            var data_1 = JSON.parse(localStorage[this.dbName]);
            data_1.push(todoItem);
            localStorage.setItem(this.dbName, JSON.stringify(data_1));
            return data_1;
        }
        var data = [todoItem];
        localStorage.setItem(this.dbName, JSON.stringify(data));
        return data;
    };
    TodoModel.prototype.getDataModel = function () {
        if (!localStorage.getItem(this.dbName))
            return false;
        return localStorage.getItem(this.dbName);
    };
    TodoModel.prototype.reSetData = function (arr) {
        localStorage.clear();
        localStorage.setItem(this.dbName, JSON.stringify(arr));
    };
    TodoModel.prototype.removeData = function () {
        localStorage.clear();
    };
    return TodoModel;
}());
;
var TodoController = /** @class */ (function () {
    function TodoController() {
    }
    TodoController.prototype.getData = function () {
        if (!modelObject.getDataModel())
            return false;
        return JSON.parse(modelObject.getDataModel());
    };
    TodoController.prototype.setData = function (inputs) {
        var todoItemObject = controlerObject.handleInputs(inputs);
        modelObject.saveData(todoItemObject);
        return todoItemObject;
    };
    TodoController.prototype.handleInputs = function (inputs) {
        var obj = {};
        for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {
            var input = inputs_1[_i];
            obj[input.name] = input.value;
        }
        obj.checkbox = false;
        obj.completed = "false";
        return obj;
    };
    TodoController.prototype.makeCheckBox = function (boxCheck) {
        var index = Number(boxCheck.target.parentElement.id);
        var arr = controlerObject.getData();
        arr[index].completed = "true";
        arr[index].checkbox = !arr[index].checkbox;
        modelObject.reSetData(arr);
        return arr;
    };
    TodoController.prototype.deletElem = function (elemDel) {
        var index = Number(elemDel.target.parentElement.id);
        var arr = controlerObject.getData();
        arr.splice(index, 1);
        modelObject.reSetData(arr);
        return arr;
    };
    TodoController.prototype.deletAllElem = function (delAll) {
        modelObject.countOfIcons = 0;
        var arr = controlerObject.getData();
        modelObject.removeData();
        return arr;
    };
    return TodoController;
}());
;
var TodoView = /** @class */ (function () {
    function TodoView() {
        this.form = document.querySelector("#todoForm");
        this.template = document.querySelector("#todoItems");
        this.removeAll = document.querySelector("#todoForm");
    }
    TodoView.prototype.setEvents = function () {
        window.addEventListener("load", viewObject.onLoadFunc);
        this.form.addEventListener("submit", viewObject.formSubmit);
        this.template.addEventListener("change", viewObject.checkBoxFunc);
        this.template.addEventListener("click", viewObject.deletElemFunc);
        this.removeAll.addEventListener("click", viewObject.deletAllFunc);
    };
    TodoView.prototype.formSubmit = function (e) {
        e.preventDefault();
        var inputs = e.target.querySelectorAll("input, textarea");
        for (var _i = 0, inputs_2 = inputs; _i < inputs_2.length; _i++) {
            var input = inputs_2[_i];
            if (!input.value.length)
                return alert("No way you can add this shit");
        }
        controlerObject.setData(inputs);
        var todoItemObject = controlerObject.getData()[controlerObject.getData().length - 1];
        viewObject.renderItem(todoItemObject);
        e.target.reset();
    };
    TodoView.prototype.onLoadFunc = function () {
        if (!localStorage.getItem("saved_data"))
            return false;
        modelObject.countOfIcons = 0;
        controlerObject.getData().forEach(function (item) { return viewObject.renderItem(item); });
    };
    TodoView.prototype.checkBoxFunc = function (boxCheck) {
        controlerObject.makeCheckBox(boxCheck);
        // console.log(setEvent.template);
        viewObject.template.textContent = "";
        viewObject.onLoadFunc();
    };
    TodoView.prototype.deletElemFunc = function (elemDel) {
        if (elemDel.target.className === 'taskButton') {
            controlerObject.deletElem(elemDel);
            viewObject.template.innerHTML = '';
            viewObject.onLoadFunc();
        }
    };
    TodoView.prototype.deletAllFunc = function (delAll) {
        console.log(delAll.target);
        if (delAll.target.className === 'del') {
            controlerObject.deletAllElem(delAll);
            viewObject.template.innerHTML = '';
        }
    };
    TodoView.prototype.createTemplate = function (titleText, descriptionText, completedText, checkboxTick, buttonText) {
        if (titleText === void 0) { titleText = ""; }
        if (descriptionText === void 0) { descriptionText = ""; }
        if (completedText === void 0) { completedText = ""; }
        if (checkboxTick === void 0) { checkboxTick = false; }
        if (buttonText === void 0) { buttonText = "Delete element"; }
        var mainWrp = document.createElement("div");
        mainWrp.className = "col-4";
        var wrp = document.createElement("div");
        wrp.className = "taskWrapper";
        // console.log(setEvent.num)
        wrp.id = modelObject.countOfIcons++;
        mainWrp.append(wrp);
        var title = document.createElement("div");
        title.innerHTML = titleText;
        title.className = "taskHeading";
        wrp.append(title);
        var description = document.createElement("div");
        description.innerHTML = descriptionText;
        description.className = "taskDescription";
        wrp.append(description);
        var completed = document.createElement("div");
        completed.innerHTML = completedText;
        completed.className = "taskCompleted";
        wrp.append(completed);
        var checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = checkboxTick;
        checkbox.className = "taskCheckbox";
        wrp.append(checkbox);
        var button = document.createElement("button");
        button.innerHTML = buttonText;
        button.className = "taskButton";
        wrp.append(button);
        return mainWrp;
    };
    TodoView.prototype.renderItem = function (_a) {
        var title = _a.title, description = _a.description, completed = _a.completed, checkbox = _a.checkbox;
        var template = viewObject.createTemplate(title, description, completed, checkbox);
        var doItem = document.querySelector("#todoItems");
        doItem.prepend(template);
    };
    TodoView.prototype.creatDeleteAllButt = function (deleteAllText) {
        if (deleteAllText === void 0) { deleteAllText = 'Delete All'; }
        var deleteAll = document.createElement("button");
        var dellBut = document.querySelector("#todoForm");
        var spanOuter = document.createElement("span");
        var spanInner = document.createElement("span");
        deleteAll.append(spanOuter);
        spanOuter.append(spanInner);
        spanOuter.className = "buttonDel__text";
        spanInner.innerHTML = deleteAllText;
        spanInner.className = "del";
        deleteAll.className = "buttonDel";
        deleteAll.setAttribute('type', 'button');
        dellBut.append(deleteAll);
        console.log(deleteAll);
    };
    return TodoView;
}());
;
var controlerObject = new TodoController();
var viewObject = new TodoView();
var modelObject = new TodoModel();
// console.log(modelObject);
viewObject.setEvents();
viewObject.creatDeleteAllButt();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFrQixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYy8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcblwidXNlIHN0cmljdFwiO1xuXG4vL+KAlCDQlNC+0LHQsNCy0LjRgtGMINC6INC60LDQttC00L7QvNGDIHRvZG8gaXRlbSDQutC+0YLQvtGA0YvQuSDRgdC+0LfQtNCw0LXRgtGB0Y8g0L/RgNC4INGB0LDQsdC80LjRgtC1INGE0L7RgNC80Ysg0L/QvtC70LUgY29tcGxldGVkXG4vL+KAlCDQv9C+0LvQtSBjb21wbGV0ZWQg0LTQvtC70LbQvdC+INGB0L7QtNC10YDQttCw0YLRjCBmYWxzZSDQutC+0LPQtNCwINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDRgtC+0LvRjNC60L4g0YfRgtC+INGB0L7Qt9C00LDQuyB0b2RvIGl0ZW1cbi8v4oCUINCf0L7Qu9C1IGNvbXBsZXRlZCDQvNC+0LbQvdC+INC40LfQvNC10L3QuNGC0Ywg0L/RgNGP0LzQviDQuNC3INGN0LvQtdC80LXQvdGC0LAgdG9kbyBodHRwOi8vam94aS5ydS9HcnFYMEpMZjR2MVk1QSDigJQg0L3Rg9C20L3QviDQtNC+0LHQsNCy0LjRgtGMINCyINC90LXQs9C+IGNoZWNrYm94XG4vL+KAlCDQldGB0LvQuCDQt9Cw0LTQsNGH0LAg0L3QtSDQstGL0L/QvtC70L3QtdC90LAg4oCUINC90LXQttC90L4g0YfRgtC+0LHRiyDQsiDRh9C10LrQsdC+0LrRgdC1INC90LUg0LHRi9C70L4g0LPQsNC70L7Rh9C60LgsINCwINC10YHQu9C4INCy0YvQv9C+0LvQvdC10L3QsCDigJQg0YfRgtC+0LHRiyDQsdGL0LvQsCAo0YHRgNCw0LfRgyDQv9C+0YHQu9C1INGB0L7Qt9C00LDQvdC40Y8gdG9kbyBpdGVtINCz0LDQu9C+0YfQutC4INC90LXRgtGDKVxuLy/igJQg0JXRgdC70Lgg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINC90LDQttC40LzQsNC10YIg0L3QsCDRgtC10LrRg9GJ0LXQvCDRjdC70LXQvNC10L3RgtC1INC90LAg0LPQsNC70L7Rh9C60YMg0YLQviDQvdGD0LbQvdC+INC40LfQvNC10L3Rj9GC0Ywg0YHRgtCw0YLRg9GBINGC0LXQutGD0YnQtdC5INC30LDQtNCw0YfQuCDQvdCwINCy0YvQv9C+0LvQvdC10L3QvdGL0LkgKGNvbXBsZXRlZDogdHJ1ZSlcbi8v4oCUINCi0LDQuiDQutCw0Log0LLRgdC1IHRvZG8gaXRlbXMg0YMg0L3QsNGBINGF0YDQsNC90Y/RgtGB0Y8g0LIg0LzQsNGB0YHQuNCy0LUg0LLQvdGD0YLRgNC4IGxvY2FsU3RvcmFnZSDRgtC+INGBINC90LjQvCDQvdCw0Lwg0Lgg0L3Rg9C20L3QviDRgNCw0LHQvtGC0LDRgtGMXG4vL+KAlCDQlNC+0LHQsNCy0LjRgtGMINCy0L7Qt9C80L7QttC90L7RgdGC0Ywg0YPQtNCw0LvRj9GC0Ywg0LrQsNC20LTRi9C5INC+0YLQtNC10LvRjNC90YvQuSB0b2RvIGl0ZW1cbi8v4oCUINCU0L7QsdCw0LLQuNGC0Ywg0LLQvtC30LzQvtC20L3QvtGB0YLRjCDRg9C00LDQu9GP0YLRjCDRgdGA0LDQt9GDINCy0YHQtSB0b2RvIGl0ZW1zXG4vLyAvLyBcInVzZSBzdHJpY3RcIjtcblxuLy8gLy8gLy/igJQg0JTQvtCx0LDQstC40YLRjCDQuiDQutCw0LbQtNC+0LzRgyB0b2RvIGl0ZW0g0LrQvtGC0L7RgNGL0Lkg0YHQvtC30LTQsNC10YLRgdGPINC/0YDQuCDRgdCw0LHQvNC40YLQtSDRhNC+0YDQvNGLINC/0L7Qu9C1IGNvbXBsZXRlZFxuLy8gLy8gLy/igJQg0L/QvtC70LUgY29tcGxldGVkINC00L7Qu9C20L3QviDRgdC+0LTQtdGA0LbQsNGC0YwgZmFsc2Ug0LrQvtCz0LTQsCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Ywg0YLQvtC70YzQutC+INGH0YLQviDRgdC+0LfQtNCw0LsgdG9kbyBpdGVtXG4vLyAvLyAvL+KAlCDQn9C+0LvQtSBjb21wbGV0ZWQg0LzQvtC20L3QviDQuNC30LzQtdC90LjRgtGMINC/0YDRj9C80L4g0LjQtyDRjdC70LXQvNC10L3RgtCwIHRvZG8gaHR0cDovL2pveGkucnUvR3JxWDBKTGY0djFZNUEg4oCUINC90YPQttC90L4g0LTQvtCx0LDQstC40YLRjCDQsiDQvdC10LPQviBjaGVja2JveFxuLy8gLy8gLy/igJQg0JXRgdC70Lgg0LfQsNC00LDRh9CwINC90LUg0LLRi9C/0L7Qu9C90LXQvdCwIOKAlCDQvdC10LbQvdC+INGH0YLQvtCx0Ysg0LIg0YfQtdC60LHQvtC60YHQtSDQvdC1INCx0YvQu9C+INCz0LDQu9C+0YfQutC4LCDQsCDQtdGB0LvQuCDQstGL0L/QvtC70L3QtdC90LAg4oCUINGH0YLQvtCx0Ysg0LHRi9C70LAgKNGB0YDQsNC30YMg0L/QvtGB0LvQtSDRgdC+0LfQtNCw0L3QuNGPIHRvZG8gaXRlbSDQs9Cw0LvQvtGH0LrQuCDQvdC10YLRgylcbi8vIC8vIC8v4oCUINCV0YHQu9C4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDQvdCw0LbQuNC80LDQtdGCINC90LAg0YLQtdC60YPRidC10Lwg0Y3Qu9C10LzQtdC90YLQtSDQvdCwINCz0LDQu9C+0YfQutGDINGC0L4g0L3Rg9C20L3QviDQuNC30LzQtdC90Y/RgtGMINGB0YLQsNGC0YPRgSDRgtC10LrRg9GJ0LXQuSDQt9Cw0LTQsNGH0Lgg0L3QsCDQstGL0L/QvtC70L3QtdC90L3Ri9C5IChjb21wbGV0ZWQ6IHRydWUpXG4vLyAvLyAvL+KAlCDQotCw0Log0LrQsNC6INCy0YHQtSB0b2RvIGl0ZW1zINGDINC90LDRgSDRhdGA0LDQvdGP0YLRgdGPINCyINC80LDRgdGB0LjQstC1INCy0L3Rg9GC0YDQuCBsb2NhbFN0b3JhZ2Ug0YLQviDRgSDQvdC40Lwg0L3QsNC8INC4INC90YPQttC90L4g0YDQsNCx0L7RgtCw0YLRjFxuLy8gLy8gLy/igJQg0JTQvtCx0LDQstC40YLRjCDQstC+0LfQvNC+0LbQvdC+0YHRgtGMINGD0LTQsNC70Y/RgtGMINC60LDQttC00YvQuSDQvtGC0LTQtdC70YzQvdGL0LkgdG9kbyBpdGVtXG4vLyAvLyAvL+KAlCDQlNC+0LHQsNCy0LjRgtGMINCy0L7Qt9C80L7QttC90L7RgdGC0Ywg0YPQtNCw0LvRj9GC0Ywg0YHRgNCw0LfRgyDQstGB0LUgdG9kbyBpdGVtc1xuXG5jbGFzcyBUb2RvTW9kZWx7XG4gIGRiTmFtZTpzdHJpbmc9XCJzYXZlZF9kYXRhXCJcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gdGhpcy5kYk5hbWUgPSBcInNhdmVkX2RhdGFcIjtcbiAgICAvLyB0aGlzLm51bSA9IDA7XG4gIH1cbiAgX2NvdW50T2ZJY29uczpudW1iZXIgPSAwO1xuICBnZXQgY291bnRPZkljb25zKCkge1xuICAgIHJldHVybiB0aGlzLl9jb3VudE9mSWNvbnM7XG4gIH1cbiAgICBzZXQgY291bnRPZkljb25zKG51bWJlclZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2NvdW50T2ZJY29ucyA9IG51bWJlclZhbHVlO1xuICAgIH1cbiAgc2F2ZURhdGEodG9kb0l0ZW06b2JqZWN0KSB7XG4gICAgaWYgKGxvY2FsU3RvcmFnZVt0aGlzLmRiTmFtZV0pIHtcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZVt0aGlzLmRiTmFtZV0pO1xuICAgICAgZGF0YS5wdXNoKHRvZG9JdGVtKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuZGJOYW1lLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgY29uc3QgZGF0YSA9IFt0b2RvSXRlbV07XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5kYk5hbWUsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICBnZXREYXRhTW9kZWwoKSB7XG4gICAgaWYgKCFsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmRiTmFtZSkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5kYk5hbWUpO1xuICB9XG4gIHJlU2V0RGF0YShhcnI6T2JqZWN0KSB7XG4gICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5kYk5hbWUsIEpTT04uc3RyaW5naWZ5KGFycikpO1xuICB9XG4gIHJlbW92ZURhdGEoKSB7XG4gICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XG4gIH1cbn07XG5cblxuY2xhc3MgVG9kb0NvbnRyb2xsZXIgIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgXG4gIFxuICB9XG4gIFxuICBnZXREYXRhKCkge1xuICAgIGlmICghbW9kZWxPYmplY3QuZ2V0RGF0YU1vZGVsKCkpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShtb2RlbE9iamVjdC5nZXREYXRhTW9kZWwoKSk7XG4gIH1cbiAgc2V0RGF0YShpbnB1dHM6T2JqZWN0KSB7XG4gICAgY29uc3QgdG9kb0l0ZW1PYmplY3Q6T2JqZWN0ID0gY29udHJvbGVyT2JqZWN0LmhhbmRsZUlucHV0cyhpbnB1dHMpO1xuICAgIG1vZGVsT2JqZWN0LnNhdmVEYXRhKHRvZG9JdGVtT2JqZWN0KTtcbiAgICByZXR1cm4gdG9kb0l0ZW1PYmplY3Q7XG4gIH1cbiAgaGFuZGxlSW5wdXRzKGlucHV0czphbnkpIHtcbiAgICBjb25zdCBvYmo6YW55ID0ge307XG4gICAgZm9yIChjb25zdCBpbnB1dCBvZiBpbnB1dHMpIHtcbiAgICAgIG9ialtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH1cbiAgICBvYmouY2hlY2tib3ggPSBmYWxzZTtcbiAgICBvYmouY29tcGxldGVkID0gXCJmYWxzZVwiO1xuICAgIHJldHVybiBvYmo7XG4gIH1cbiAgbWFrZUNoZWNrQm94KGJveENoZWNrOmFueSkge1xuICAgIGxldCBpbmRleCA9IE51bWJlcihib3hDaGVjay50YXJnZXQucGFyZW50RWxlbWVudC5pZCk7XG4gICAgY29uc3QgYXJyID0gY29udHJvbGVyT2JqZWN0LmdldERhdGEoKTtcbiAgICBhcnJbaW5kZXhdLmNvbXBsZXRlZCA9IFwidHJ1ZVwiO1xuICAgIGFycltpbmRleF0uY2hlY2tib3ggPSAhYXJyW2luZGV4XS5jaGVja2JveDtcbiAgICBtb2RlbE9iamVjdC5yZVNldERhdGEoYXJyKTtcbiAgICByZXR1cm4gYXJyO1xuICB9XG4gIGRlbGV0RWxlbShlbGVtRGVsOmFueSkge1xuICAgIGxldCBpbmRleCA9IE51bWJlcihlbGVtRGVsLnRhcmdldC5wYXJlbnRFbGVtZW50LmlkKTtcbiAgICBjb25zdCBhcnIgPSBjb250cm9sZXJPYmplY3QuZ2V0RGF0YSgpO1xuICAgIGFyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIG1vZGVsT2JqZWN0LnJlU2V0RGF0YShhcnIpXG4gICAgcmV0dXJuIGFycjtcbiAgfVxuICBkZWxldEFsbEVsZW0oZGVsQWxsOmFueSkge1xuICAgIG1vZGVsT2JqZWN0LmNvdW50T2ZJY29ucz0wO1xuICAgIGNvbnN0IGFyciA9IGNvbnRyb2xlck9iamVjdC5nZXREYXRhKCk7XG4gICAgbW9kZWxPYmplY3QucmVtb3ZlRGF0YSgpO1xuICAgIHJldHVybiBhcnI7XG4gIH1cbn07XG5jbGFzcyBUb2RvVmlldyB7XG4gIGZvcm07XG4gIHRlbXBsYXRlO1xuICByZW1vdmVBbGw7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIFxuICAgIHRoaXMuZm9ybSA9IDxIVE1MRm9ybUVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvRm9ybVwiKTtcbiAgICB0aGlzLnRlbXBsYXRlID0gPEhUTUxEaXZFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kb0l0ZW1zXCIpO1xuICAgIHRoaXMucmVtb3ZlQWxsID0gPEhUTUxGb3JtRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RvZG9Gb3JtXCIpO1xuICB9XG4gIHNldEV2ZW50cygpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgdmlld09iamVjdC5vbkxvYWRGdW5jKTtcbiAgICB0aGlzLmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB2aWV3T2JqZWN0LmZvcm1TdWJtaXQpO1xuICAgIHRoaXMudGVtcGxhdGUuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCB2aWV3T2JqZWN0LmNoZWNrQm94RnVuYyk7XG4gICAgdGhpcy50ZW1wbGF0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdmlld09iamVjdC5kZWxldEVsZW1GdW5jKTtcbiAgICB0aGlzLnJlbW92ZUFsbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdmlld09iamVjdC5kZWxldEFsbEZ1bmMpO1xuICB9XG4gIGZvcm1TdWJtaXQoZTphbnkpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgaW5wdXRzID0gZS50YXJnZXQucXVlcnlTZWxlY3RvckFsbChcImlucHV0LCB0ZXh0YXJlYVwiKTtcblxuICAgIGZvciAoY29uc3QgaW5wdXQgb2YgaW5wdXRzKSB7XG4gICAgICBpZiAoIWlucHV0LnZhbHVlLmxlbmd0aCkgcmV0dXJuIGFsZXJ0KFwiTm8gd2F5IHlvdSBjYW4gYWRkIHRoaXMgc2hpdFwiKTtcbiAgICB9XG4gICAgY29udHJvbGVyT2JqZWN0LnNldERhdGEoaW5wdXRzKTtcbiAgICBjb25zdCB0b2RvSXRlbU9iamVjdCA9XG4gICAgY29udHJvbGVyT2JqZWN0LmdldERhdGEoKVtjb250cm9sZXJPYmplY3QuZ2V0RGF0YSgpLmxlbmd0aCAtIDFdO1xuICAgIHZpZXdPYmplY3QucmVuZGVySXRlbSh0b2RvSXRlbU9iamVjdCk7XG4gICAgZS50YXJnZXQucmVzZXQoKTtcbiAgfVxuICBvbkxvYWRGdW5jKCkge1xuICAgIGlmICghbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzYXZlZF9kYXRhXCIpKSByZXR1cm4gZmFsc2U7XG4gICAgbW9kZWxPYmplY3QuY291bnRPZkljb25zPTA7XG4gICAgY29udHJvbGVyT2JqZWN0LmdldERhdGEoKS5mb3JFYWNoKChpdGVtOmFueSkgPT4gdmlld09iamVjdC5yZW5kZXJJdGVtKGl0ZW0pKTtcbiAgfVxuICBjaGVja0JveEZ1bmMoYm94Q2hlY2s6YW55KSB7XG4gICAgY29udHJvbGVyT2JqZWN0Lm1ha2VDaGVja0JveChib3hDaGVjayk7XG4gICAgLy8gY29uc29sZS5sb2coc2V0RXZlbnQudGVtcGxhdGUpO1xuICAgIHZpZXdPYmplY3QudGVtcGxhdGUudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHZpZXdPYmplY3Qub25Mb2FkRnVuYygpO1xuICB9XG4gIGRlbGV0RWxlbUZ1bmMoZWxlbURlbDphbnkpIHtcbiAgICBpZiAoZWxlbURlbC50YXJnZXQuY2xhc3NOYW1lID09PSAndGFza0J1dHRvbicpIHtcbiAgICAgIGNvbnRyb2xlck9iamVjdC5kZWxldEVsZW0oZWxlbURlbCk7XG4gICAgICB2aWV3T2JqZWN0LnRlbXBsYXRlLmlubmVySFRNTCA9ICcnO1xuICAgICAgdmlld09iamVjdC5vbkxvYWRGdW5jKCk7XG4gICAgfVxuICB9XG4gIGRlbGV0QWxsRnVuYyhkZWxBbGw6YW55KSB7XG4gICAgY29uc29sZS5sb2coZGVsQWxsLnRhcmdldCk7XG4gICAgaWYgKGRlbEFsbC50YXJnZXQuY2xhc3NOYW1lID09PSAnZGVsJykge1xuICAgICAgY29udHJvbGVyT2JqZWN0LmRlbGV0QWxsRWxlbShkZWxBbGwpO1xuICAgICAgdmlld09iamVjdC50ZW1wbGF0ZS5pbm5lckhUTUwgPSAnJztcblxuICAgIH1cbiAgfVxuICBjcmVhdGVUZW1wbGF0ZShcbiAgICB0aXRsZVRleHQgPSBcIlwiLFxuICAgIGRlc2NyaXB0aW9uVGV4dCA9IFwiXCIsXG4gICAgY29tcGxldGVkVGV4dCA9IFwiXCIsXG4gICAgY2hlY2tib3hUaWNrID0gZmFsc2UsXG4gICAgYnV0dG9uVGV4dCA9IFwiRGVsZXRlIGVsZW1lbnRcIixcbiAgKSB7XG4gICAgY29uc3QgbWFpbldycCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICBtYWluV3JwLmNsYXNzTmFtZSA9IFwiY29sLTRcIjtcblxuICAgIGNvbnN0IHdycCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgd3JwLmNsYXNzTmFtZSA9IFwidGFza1dyYXBwZXJcIjtcbiAgICAvLyBjb25zb2xlLmxvZyhzZXRFdmVudC5udW0pXG4gICAgd3JwLmlkID0gbW9kZWxPYmplY3QuY291bnRPZkljb25zKys7XG4gICAgbWFpbldycC5hcHBlbmQod3JwKTtcblxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0aXRsZS5pbm5lckhUTUwgPSB0aXRsZVRleHQ7XG4gICAgdGl0bGUuY2xhc3NOYW1lID0gXCJ0YXNrSGVhZGluZ1wiO1xuICAgIHdycC5hcHBlbmQodGl0bGUpO1xuXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGRlc2NyaXB0aW9uLmlubmVySFRNTCA9IGRlc2NyaXB0aW9uVGV4dDtcbiAgICBkZXNjcmlwdGlvbi5jbGFzc05hbWUgPSBcInRhc2tEZXNjcmlwdGlvblwiO1xuICAgIHdycC5hcHBlbmQoZGVzY3JpcHRpb24pO1xuXG4gICAgY29uc3QgY29tcGxldGVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjb21wbGV0ZWQuaW5uZXJIVE1MID0gY29tcGxldGVkVGV4dDtcbiAgICBjb21wbGV0ZWQuY2xhc3NOYW1lID0gXCJ0YXNrQ29tcGxldGVkXCI7XG4gICAgd3JwLmFwcGVuZChjb21wbGV0ZWQpO1xuXG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgY2hlY2tib3gudHlwZSA9IFwiY2hlY2tib3hcIjtcbiAgICBjaGVja2JveC5jaGVja2VkID0gY2hlY2tib3hUaWNrO1xuICAgIGNoZWNrYm94LmNsYXNzTmFtZSA9IFwidGFza0NoZWNrYm94XCI7XG4gICAgd3JwLmFwcGVuZChjaGVja2JveCk7XG5cbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBidXR0b25UZXh0O1xuICAgIGJ1dHRvbi5jbGFzc05hbWUgPSBcInRhc2tCdXR0b25cIjtcbiAgICB3cnAuYXBwZW5kKGJ1dHRvbik7XG5cbiAgICByZXR1cm4gbWFpbldycDtcbiAgfVxuICByZW5kZXJJdGVtKHsgdGl0bGUsIGRlc2NyaXB0aW9uLCBjb21wbGV0ZWQsIGNoZWNrYm94IH06YW55KSB7XG4gICAgY29uc3QgdGVtcGxhdGUgPSB2aWV3T2JqZWN0LmNyZWF0ZVRlbXBsYXRlKFxuICAgICAgdGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIGNvbXBsZXRlZCxcbiAgICAgIGNoZWNrYm94XG4gICAgKTtcbiAgICBsZXQgZG9JdGVtID0gPEhUTUxEaXZFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdG9kb0l0ZW1zXCIpXG4gICAgZG9JdGVtLnByZXBlbmQodGVtcGxhdGUpO1xuICB9XG4gIGNyZWF0RGVsZXRlQWxsQnV0dChkZWxldGVBbGxUZXh0ID0gJ0RlbGV0ZSBBbGwnKSB7XG4gICAgY29uc3QgZGVsZXRlQWxsID0gPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgY29uc3QgZGVsbEJ1dCA9IDxIVE1MRm9ybUVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0b2RvRm9ybVwiKTtcbiAgICBjb25zdCBzcGFuT3V0ZXIgPSA8SFRNTFNwYW5FbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIGNvbnN0IHNwYW5Jbm5lciA9IDxIVE1MU3BhbkVsZW1lbnQ+ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgZGVsZXRlQWxsLmFwcGVuZChzcGFuT3V0ZXIpO1xuICAgIHNwYW5PdXRlci5hcHBlbmQoc3BhbklubmVyKTtcbiAgICBzcGFuT3V0ZXIuY2xhc3NOYW1lID0gXCJidXR0b25EZWxfX3RleHRcIjtcbiAgICBzcGFuSW5uZXIuaW5uZXJIVE1MID0gZGVsZXRlQWxsVGV4dDtcbiAgICBzcGFuSW5uZXIuY2xhc3NOYW1lID0gXCJkZWxcIjtcbiAgICBkZWxldGVBbGwuY2xhc3NOYW1lID0gXCJidXR0b25EZWxcIjtcbiAgICBkZWxldGVBbGwuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpO1xuICAgIGRlbGxCdXQuYXBwZW5kKGRlbGV0ZUFsbCk7XG4gICAgY29uc29sZS5sb2coZGVsZXRlQWxsKTtcbiAgICBcbiAgfVxufTtcblxuXG5sZXQgY29udHJvbGVyT2JqZWN0ID0gbmV3IFRvZG9Db250cm9sbGVyKCk7XG5sZXQgdmlld09iamVjdCA9IG5ldyBUb2RvVmlldygpO1xubGV0IG1vZGVsT2JqZWN0OmFueSA9IG5ldyBUb2RvTW9kZWwoKTtcblxuLy8gY29uc29sZS5sb2cobW9kZWxPYmplY3QpO1xudmlld09iamVjdC5zZXRFdmVudHMoKTtcbnZpZXdPYmplY3QuY3JlYXREZWxldGVBbGxCdXR0KClcbi8vIGNvbnNvbGUubG9nKHNldEV2ZW50KVxuXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=